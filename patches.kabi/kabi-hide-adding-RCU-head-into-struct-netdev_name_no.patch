From: Michal Kubecek <mkubecek@suse.cz>
Date: Mon, 20 Jan 2025 13:32:09 +0100
Subject: kabi: hide adding RCU head into struct netdev_name_node
Patch-mainline: Never, kabi workaround
References: bsc#1233749

The backport of mainline commit 723de3ebef03 ("net: free altname using an
RCU callback") adds a new member (RCU head) into struct netdev_name_node.
Thankfully this structure is never embedded anywhere, only referenced via
pointers and allocated via in-kernel helpers so that we can simply hide the
new member from genksyms (it was added at the end of the structure).

Signed-off-by: Michal Kubecek <mkubecek@suse.cz>
---
 include/linux/netdevice.h | 2 ++
 1 file changed, 2 insertions(+)

--- a/include/linux/netdevice.h
+++ b/include/linux/netdevice.h
@@ -1018,7 +1018,9 @@ struct netdev_name_node {
 	struct list_head list;
 	struct net_device *dev;
 	const char *name;
+#ifndef __GENKSYMS__
 	struct rcu_head rcu;
+#endif
 };
 
 #define netdev_for_each_altname(dev, namenode)				\

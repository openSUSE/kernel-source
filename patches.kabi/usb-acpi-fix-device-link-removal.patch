From ef8d42e894f06f1cb39300148c434a6510229d9e Mon Sep 17 00:00:00 2001
From: Oliver Neukum <oneukum@suse.com>
Date: Mon, 17 Nov 2025 13:17:02 +0100
Subject: [PATCH] usb: acpi: fix device link removal
Patch-mainline: Never (kABI fixup)
References: git-fixes

1) It comes from usb_alloc_dev()
2) Is needed only in SL-16.0

Convert the suse_kabi_padding member

Signed-off-by: Oliver Neukum <oneukum@suse.com>
Reviewed-by: Takashi Iwai <tiwai@suse.de>
---
 include/linux/usb.h | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/include/linux/usb.h b/include/linux/usb.h
index c12fc8a57..713672f82 100644
--- a/include/linux/usb.h
+++ b/include/linux/usb.h
@@ -728,7 +728,6 @@ struct usb_device {
 	unsigned reset_resume:1;
 	unsigned port_is_suspended:1;
 	enum usb_link_tunnel_mode tunnel_mode;
-	struct device_link *usb4_link;
 
 	int slot_id;
 	struct usb2_lpm_parameters l1_params;
@@ -738,8 +737,11 @@ struct usb_device {
 
 	u16 hub_delay;
 	unsigned use_generic_driver:1;
-
+#ifdef __GENKSYMS__
 	void *suse_kabi_padding;
+#else
+	struct device_link *usb4_link;
+#endif
 };
 
 #define to_usb_device(__dev)	container_of_const(__dev, struct usb_device, dev)
-- 
2.51.1


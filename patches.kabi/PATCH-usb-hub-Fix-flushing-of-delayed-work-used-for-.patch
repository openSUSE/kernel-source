From 49151686ef21c7355a827b67aec06a5f88a44e27 Mon Sep 17 00:00:00 2001
From: Oliver Neukum <oneukum@suse.com>
Date: Mon, 17 Nov 2025 16:48:28 +0100
Subject: [PATCH] [PATCH] usb: hub: Fix flushing of delayed work used for post
 resume purposes
References: git-fixes
Patch-mainlne: Never (kABI fixup)

Centrally allocated in hub_probe()
It can be extended

Signed-off-by: Oliver Neukum <oneukum@suse.com>
Reviewed-by: Takashi Iwai <tiwai@suse.de>
---
 drivers/usb/core/hub.h | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/drivers/usb/core/hub.h b/drivers/usb/core/hub.h
index 9ebc5ef54..cc488aaa2 100644
--- a/drivers/usb/core/hub.h
+++ b/drivers/usb/core/hub.h
@@ -70,12 +70,14 @@ struct usb_hub {
 	u8			indicator[USB_MAXCHILDREN];
 	struct delayed_work	leds;
 	struct delayed_work	init_work;
-	struct delayed_work	post_resume_work;
 	struct work_struct      events;
 	spinlock_t		irq_urb_lock;
 	struct timer_list	irq_urb_retry;
 	struct usb_port		**ports;
 	struct list_head        onboard_devs;
+#ifndef __GENKSYMS__
+	struct delayed_work	post_resume_work;
+#endif
 };
 
 /**
-- 
2.51.1


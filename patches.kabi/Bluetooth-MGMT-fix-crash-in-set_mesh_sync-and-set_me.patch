From: Takashi Iwai <tiwai@suse.de>
Subject: kABI workaround for mgmt_cp_set_mesh struct change
Patch-mainline: Never, kABI workaround
References: git-fixes

The backport of the BT fix commit e8785404de06 added __counted_by()
attribute for the flex array, which broke kABI.
As it's only a decoration for the checkers, guard it with the
standard ifdef for keeping kABI.

Reviewed-by: Jan Kara <jack@suse.cz>
Signed-off-by: Takashi Iwai <tiwai@suse.de>

---
 include/net/bluetooth/mgmt.h |    6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

--- a/include/net/bluetooth/mgmt.h
+++ b/include/net/bluetooth/mgmt.h
@@ -847,7 +847,11 @@ struct mgmt_cp_set_mesh {
 	__le16 window;
 	__le16 period;
 	__u8   num_ad_types;
-	__u8   ad_types[] __counted_by(num_ad_types);
+	__u8   ad_types[]
+#ifndef __GENKSYMS__
+		__counted_by(num_ad_types)
+#endif
+		;
 } __packed;
 #define MGMT_SET_MESH_RECEIVER_SIZE	6
 

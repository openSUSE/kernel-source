From: Theodore Ts'o <tytso@mit.edu>
Date: Fri, 25 Jan 2013 04:24:56 +0000 (-0500)
Subject: quota: autoload the quota_v2 module for QFMT_VFS_V1 quota format
Git-repo: git://git.kernel.org/pub/scm/linux/kernel/git/tytso/ext4.git
Git-commit: c3ad83d9efdfe6a86efd44945a781f00c879b7b4
Patch-mainline: Queued in subsystem maintainer repo
References: bnc#802153

quota: autoload the quota_v2 module for QFMT_VFS_V1 quota format

Otherwise, ext4 file systems with the quota featured enable will get a
very confusing "No such process" error message if the quota code is
built as a module and the quota_v2 module has not been loaded.

Signed-off-by: "Theodore Ts'o" <tytso@mit.edu>
Reviewed-by: Carlos Maiolino <cmaiolino@redhat.com>
Acked-by: Jan Kara <jack@suse.cz>
Cc: stable@vger.kernel.org
Acked-by: Jeff Mahoney <jeffm@suse.com>
---

 include/linux/quota.h |    1 +
 1 file changed, 1 insertion(+)

diff --git a/include/linux/quota.h b/include/linux/quota.h
index 58fdef12..d133711 100644
--- a/include/linux/quota.h
+++ b/include/linux/quota.h
@@ -405,6 +405,7 @@ struct quota_module_name {
 #define INIT_QUOTA_MODULE_NAMES {\
 	{QFMT_VFS_OLD, "quota_v1"},\
 	{QFMT_VFS_V0, "quota_v2"},\
+	{QFMT_VFS_V1, "quota_v2"},\
 	{0, NULL}}
 
 #endif /* _QUOTA_ */


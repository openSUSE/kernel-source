From: Dan Rosenberg <dan.j.rosenberg@gmail.com>
Subject: [PATCH] drivers/net/usb/hso.c: prevent reading uninitialized memory
References: CVE-2010-3298 bnc#639483
Patch-mainline: Submitted Sep 11, 2010
Introduced-by: 2.6.29

The TIOCGICOUNT device ioctl allows unprivileged users to read 9 bytes
of uninitialized stack memory, because the "reserved" member of the
serial_icounter_struct struct declared on the stack in hso_get_count()
is not altered or zeroed before being copied back to the user.  This
patch takes care of it.

Signed-off-by: Dan Rosenberg <dan.j.rosenberg@gmail.com>
Acked-by: Jeff Mahoney <jeffm@suse.com>
---

 drivers/net/usb/hso.c |    2 ++
 1 file changed, 2 insertions(+)

--- a/drivers/net/usb/hso.c
+++ b/drivers/net/usb/hso.c
@@ -1652,6 +1652,8 @@ static int hso_get_count(struct hso_seri
 	struct uart_icount cnow;
 	struct hso_tiocmget  *tiocmget = serial->tiocmget;
 
+	memset(&icount, 0, sizeof(struct serial_icounter_struct));
+
 	if (!tiocmget)
 		 return -ENOENT;
 	spin_lock_irq(&serial->serial_lock);

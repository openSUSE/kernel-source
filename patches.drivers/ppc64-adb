From: Olaf Hering <olh@suse.de>
Subject: enable mouse button emulation also for G5

fix compile errors

 drivers/macintosh/Kconfig  |    2 +-
 drivers/macintosh/adb.c    |    4 ++++
 drivers/macintosh/adbhid.c |    6 +++++-
 3 files changed, 10 insertions(+), 2 deletions(-)

Index: linux-2.6.12/drivers/macintosh/adb.c
===================================================================
--- linux-2.6.12.orig/drivers/macintosh/adb.c
+++ linux-2.6.12/drivers/macintosh/adb.c
@@ -297,6 +297,10 @@ int __init adb_init(void)
 	if ( (_machine != _MACH_chrp) && (_machine != _MACH_Pmac) )
 		return 0;
 #endif
+#ifdef CONFIG_PPC64
+	if (_machine != _MACH_Pmac)
+		return 0;
+#endif
 #ifdef CONFIG_MAC
 	if (!MACH_IS_MAC)
 		return 0;
Index: linux-2.6.12/drivers/macintosh/adbhid.c
===================================================================
--- linux-2.6.12.orig/drivers/macintosh/adbhid.c
+++ linux-2.6.12/drivers/macintosh/adbhid.c
@@ -1195,10 +1195,14 @@ init_ms_a3(int id)
 
 static int __init adbhid_init(void)
 {
-#ifndef CONFIG_MAC
+#ifdef CONFIG_PPC32
 	if ( (_machine != _MACH_chrp) && (_machine != _MACH_Pmac) )
 	    return 0;
 #endif
+#ifdef CONFIG_PPC64
+	if (_machine != _MACH_Pmac)
+		return 0;
+#endif
 
 	led_request.complete = 1;
 
Index: linux-2.6.12/drivers/macintosh/Kconfig
===================================================================
--- linux-2.6.12.orig/drivers/macintosh/Kconfig
+++ linux-2.6.12/drivers/macintosh/Kconfig
@@ -4,7 +4,7 @@ menu "Macintosh device drivers"
 
 config ADB
 	bool "Apple Desktop Bus (ADB) support"
-	depends on MAC || (PPC_PMAC && PPC32)
+	depends on MAC || PPC_PMAC
 	help
 	  Apple Desktop Bus (ADB) support is for support of devices which
 	  are connected to an ADB port.  ADB devices tend to have 4 pins.

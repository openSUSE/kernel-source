From 1d8dd982c409d89b4ffabdbe10b569b3deb80a64 Mon Sep 17 00:00:00 2001
From: Takashi Iwai <tiwai@suse.de>
Date: Wed, 30 Jul 2025 08:46:33 +0200
Subject: [PATCH] ALSA: hda/realtek: Enable drivers as default
Git-commit: 1d8dd982c409d89b4ffabdbe10b569b3deb80a64
Patch-mainline: v6.17-rc1
References: jsc#PED-14430 jsc#PED-14297 jsc#PED-14024

The recent split of Realtek HD-audio driver forced users to choose the
right Kconfigs, but most users have no idea which ones to enable.
Although the distros tend to enable all of them, individual users may
have their own favorites and miss something needed via the version
upgrade.

For smoother upgrade path from the previous kernel configuration, now
we take the following changes:

- CONFIG_SND_HDA_CODEC_REALTEK (which is a menuconfig) is changed from
  bool to tristate again, so that it can take over from the previous
  config gracefully.
- CONFIG_SND_HDA_CODEC_ALC* receive "default y", so that they are
  enabled as default as long as CONFIG_SND_HDA_CODEC_REALTEK is set.
  Those can be still disabled if users want to reduce the size, too.

At least this allows users to run "make oldconfig" and push RETURN
blindly.

Signed-off-by: Takashi Iwai <tiwai@suse.de>
Link: https://patch.msgid.link/20250730064639.25617-2-tiwai@suse.de

---
 sound/hda/codecs/realtek/Kconfig | 12 +++++++++++-
 1 file changed, 11 insertions(+), 1 deletion(-)

diff --git a/sound/hda/codecs/realtek/Kconfig b/sound/hda/codecs/realtek/Kconfig
index 4b3ab28203b4..20899f3fc051 100644
--- a/sound/hda/codecs/realtek/Kconfig
+++ b/sound/hda/codecs/realtek/Kconfig
@@ -1,7 +1,7 @@
 # SPDX-License-Identifier: GPL-2.0-only
 
 menuconfig SND_HDA_CODEC_REALTEK
-	bool "Realtek HD-audio codec support"
+	tristate "Realtek HD-audio codec support"
 
 if SND_HDA_CODEC_REALTEK
 
@@ -15,6 +15,7 @@ config SND_HDA_CODEC_ALC260
 	tristate "Build Realtek ALC260 HD-audio codec support"
 	depends on INPUT
 	select SND_HDA_CODEC_REALTEK_LIB
+	default y
 	help
 	  Say Y or M here to include Realtek ALC260 HD-audio codec support
 
@@ -22,6 +23,7 @@ config SND_HDA_CODEC_ALC262
 	tristate "Build Realtek ALC262 HD-audio codec support"
 	depends on INPUT
 	select SND_HDA_CODEC_REALTEK_LIB
+	default y
 	help
 	  Say Y or M here to include Realtek ALC262 HD-audio codec support
 
@@ -29,6 +31,7 @@ config SND_HDA_CODEC_ALC268
 	tristate "Build Realtek ALC268 HD-audio codec support"
 	depends on INPUT
 	select SND_HDA_CODEC_REALTEK_LIB
+	default y
 	help
 	  Say Y or M here to include Realtek ALC268 and compatible HD-audio
 	  codec support
@@ -37,6 +40,7 @@ config SND_HDA_CODEC_ALC269
 	tristate "Build Realtek ALC269 HD-audio codecs support"
 	depends on INPUT
 	select SND_HDA_CODEC_REALTEK_LIB
+	default y
 	help
 	  Say Y or M here to include Realtek ALC269 and compatible HD-audio
 	  codec support
@@ -45,6 +49,7 @@ config SND_HDA_CODEC_ALC662
 	tristate "Build Realtek ALC662 HD-audio codecs support"
 	depends on INPUT
 	select SND_HDA_CODEC_REALTEK_LIB
+	default y
 	help
 	  Say Y or M here to include Realtek ALC662 and compatible HD-audio
 	  codec support
@@ -53,6 +58,7 @@ config SND_HDA_CODEC_ALC680
 	tristate "Build Realtek ALC680 HD-audio codecs support"
 	depends on INPUT
 	select SND_HDA_CODEC_REALTEK_LIB
+	default y
 	help
 	  Say Y or M here to include Realtek ALC680 HD-audio codec support
 
@@ -60,6 +66,7 @@ config SND_HDA_CODEC_ALC861
 	tristate "Build Realtek ALC861 HD-audio codecs support"
 	depends on INPUT
 	select SND_HDA_CODEC_REALTEK_LIB
+	default y
 	help
 	  Say Y or M here to include Realtek ALC861 HD-audio codec support
 
@@ -67,6 +74,7 @@ config SND_HDA_CODEC_ALC861VD
 	tristate "Build Realtek ALC861-VD HD-audio codecs support"
 	depends on INPUT
 	select SND_HDA_CODEC_REALTEK_LIB
+	default y
 	help
 	  Say Y or M here to include Realtek ALC861-VD HD-audio codec support
 
@@ -74,6 +82,7 @@ config SND_HDA_CODEC_ALC880
 	tristate "Build Realtek ALC880 HD-audio codecs support"
 	depends on INPUT
 	select SND_HDA_CODEC_REALTEK_LIB
+	default y
 	help
 	  Say Y or M here to include Realtek ALC880 HD-audio codec support
 
@@ -81,6 +90,7 @@ config SND_HDA_CODEC_ALC882
 	tristate "Build Realtek ALC882 HD-audio codecs support"
 	depends on INPUT
 	select SND_HDA_CODEC_REALTEK_LIB
+	default y
 	help
 	  Say Y or M here to include Realtek ALC882 and compatible HD-audio
 	  codec support
-- 
2.52.0


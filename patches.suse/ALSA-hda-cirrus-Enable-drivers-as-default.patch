From fc2792a4000e9587080fa7f5b8a868cf393aa62e Mon Sep 17 00:00:00 2001
From: Takashi Iwai <tiwai@suse.de>
Date: Wed, 30 Jul 2025 08:46:34 +0200
Subject: [PATCH] ALSA: hda/cirrus: Enable drivers as default
Git-commit: fc2792a4000e9587080fa7f5b8a868cf393aa62e
Patch-mainline: v6.17-rc1
References: jsc#PED-14430 jsc#PED-14297 jsc#PED-14024

Like HD-audio Realtek drivers, Cirrus Logic HD-audio codec driver was
split to multiple drivers, too, and now users are forced to choose the
right kconfig items.

For smoother upgrade path, keep the previous
CONFIG_SND_HDA_CODEC_CIRRUS as the menuconfig.

The new kconfig CONFIG_SND_HDA_CODEC_CS42* are enabled as default, as
long as CONFIG_SND_HDA_CODEC_CIRRUS is set, so that the system with
Cirrus codec can keep working.

This is only about the default config, and each driver can be still
disabled if user wants to reduce the size, too.

Signed-off-by: Takashi Iwai <tiwai@suse.de>
Link: https://patch.msgid.link/20250730064639.25617-3-tiwai@suse.de

---
 sound/hda/codecs/cirrus/Kconfig | 9 +++++++++
 1 file changed, 9 insertions(+)

diff --git a/sound/hda/codecs/cirrus/Kconfig b/sound/hda/codecs/cirrus/Kconfig
index b3a5968e9a02..33cfe52713bc 100644
--- a/sound/hda/codecs/cirrus/Kconfig
+++ b/sound/hda/codecs/cirrus/Kconfig
@@ -1,8 +1,14 @@
 # SPDX-License-Identifier: GPL-2.0-only
 
+menuconfig SND_HDA_CODEC_CIRRUS
+	tristate "Cirrus Logic HD-audio codec support"
+
+if SND_HDA_CODEC_CIRRUS
+
 config SND_HDA_CODEC_CS420X
 	tristate "Build Cirrus Logic CS420x codec support"
 	select SND_HDA_GENERIC
+	default y
 	help
 	  Say Y or M here to include Cirrus Logic CS420x codec support in
 	  snd-hda-intel driver
@@ -13,6 +19,7 @@ comment "Set to Y if you want auto-loading the codec driver"
 config SND_HDA_CODEC_CS421X
 	tristate "Build Cirrus Logic CS421x codec support"
 	select SND_HDA_GENERIC
+	default y
 	help
 	  Say Y or M here to include Cirrus Logic CS421x codec support in
 	  snd-hda-intel driver
@@ -29,3 +36,5 @@ config SND_HDA_CODEC_CS8409
 
 comment "Set to Y if you want auto-loading the codec driver"
 	depends on SND_HDA=y && SND_HDA_CODEC_CS8409=m
+
+endif
-- 
2.52.0


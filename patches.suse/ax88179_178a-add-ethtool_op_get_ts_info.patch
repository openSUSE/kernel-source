From dc83ef22cdb483027f1bf0892e466433ec5299bf Mon Sep 17 00:00:00 2001
From: "Andreas K. Besslein" <besslein.andreas@gmail.com>
Date: Sat, 23 Nov 2019 22:04:47 +0100
Subject: [PATCH] ax88179_178a: add ethtool_op_get_ts_info()
Git-commit: dc83ef22cdb483027f1bf0892e466433ec5299bf
References: git-fixes
Patch-mainline: v5.5-rc1

This enables the use of SW timestamping.

ax88179_178a uses the usbnet transmit function usbnet_start_xmit() which
implements software timestamping. ax88179_178a overrides ethtool_ops but
missed to set .get_ts_info. This caused SOF_TIMESTAMPING_TX_SOFTWARE
capability to be not available.

Signed-off-by: Andreas K. Besslein <besslein.andreas@gmail.com>
Signed-off-by: Jakub Kicinski <jakub.kicinski@netronome.com>
Signed-off-by: Oliver Neukum <oneukum@suse.com>
---
 drivers/net/usb/ax88179_178a.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/drivers/net/usb/ax88179_178a.c b/drivers/net/usb/ax88179_178a.c
index c5a6e75c24e3..93044cf1417a 100644
--- a/drivers/net/usb/ax88179_178a.c
+++ b/drivers/net/usb/ax88179_178a.c
@@ -827,6 +827,7 @@ static const struct ethtool_ops ax88179_ethtool_ops = {
 	.nway_reset		= usbnet_nway_reset,
 	.get_link_ksettings	= ax88179_get_link_ksettings,
 	.set_link_ksettings	= ax88179_set_link_ksettings,
+	.get_ts_info		= ethtool_op_get_ts_info,
 };
 
 static void ax88179_set_multicast(struct net_device *net)
-- 
2.35.3


From 3b6dba220e67eda42f1263403fbbba64992da3ae Mon Sep 17 00:00:00 2001
From: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
Date: Fri, 24 Nov 2023 21:31:24 +0200
Subject: [PATCH] mfd: intel-lpss: Revert "Add missing check for platform_get_resource"
Git-commit: 3b6dba220e67eda42f1263403fbbba64992da3ae
Patch-mainline: v6.8-rc1
References: git-fixes

This reverts commit d918e0d5824495a75d00b879118b098fcab36fdb.

The commit in question does not fix anything and only introduces
a duplication in the code. The main intel_lpss_probe() performs
all necessary checks.

While at it and in order of avoiding similar patches to come, add
a comment.

Signed-off-by: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
Link: https://lore.kernel.org/r/20231124200258.3682979-2-andriy.shevchenko@linux.intel.com
Signed-off-by: Lee Jones <lee@kernel.org>
Acked-by: Takashi Iwai <tiwai@suse.de>

---
 drivers/mfd/intel-lpss-acpi.c |    4 +---
 drivers/mfd/intel-lpss-pci.c  |    1 +
 2 files changed, 2 insertions(+), 3 deletions(-)

--- a/drivers/mfd/intel-lpss-acpi.c
+++ b/drivers/mfd/intel-lpss-acpi.c
@@ -182,10 +182,8 @@ static int intel_lpss_acpi_probe(struct
 	if (!info)
 		return -ENOMEM;
 
+	/* No need to check mem and irq here as intel_lpss_probe() does it for us */
 	info->mem = platform_get_resource(pdev, IORESOURCE_MEM, 0);
-	if (!info->mem)
-		return -ENODEV;
-
 	info->irq = platform_get_irq(pdev, 0);
 
 	ret = intel_lpss_probe(&pdev->dev, info);
--- a/drivers/mfd/intel-lpss-pci.c
+++ b/drivers/mfd/intel-lpss-pci.c
@@ -42,6 +42,7 @@ static int intel_lpss_pci_probe(struct p
 	if (!info)
 		return -ENOMEM;
 
+	/* No need to check mem and irq here as intel_lpss_probe() does it for us */
 	info->mem = &pdev->resource[0];
 	info->irq = pdev->irq;
 

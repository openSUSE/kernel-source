From 66fecfa91deb536a12ddf3d878a99590d7900277 Mon Sep 17 00:00:00 2001
From: Troy Mitchell <troy.mitchell@linux.spacemit.com>
Date: Tue, 28 Oct 2025 09:32:10 +0800
Subject: [PATCH] ASoC: spacemit: use `depends on` instead of `select`
Git-commit: 66fecfa91deb536a12ddf3d878a99590d7900277
Patch-mainline: v6.19-rc1
References: jsc#PED-14430 jsc#PED-14297 jsc#PED-14024

Selecting DMA_CMA directly bypasses its dependency chain.
This can cause build warnings or errors if the required
dependencies are not enabled.

Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
Closes: https://lore.kernel.org/all/20251022141705.714b19b5@canb.auug.org.au/
Fixes: fce217449075 ("ASoC: spacemit: add i2s support for K1 SoC")
Signed-off-by: Troy Mitchell <troy.mitchell@linux.spacemit.com>
Link: https://patch.msgid.link/20251028-fix-k1-i2s-v2-2-a547c15ed5c3@linux.spacemit.com
Signed-off-by: Mark Brown <broonie@kernel.org>
Acked-by: Takashi Iwai <tiwai@suse.de>

---
 sound/soc/spacemit/Kconfig | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/sound/soc/spacemit/Kconfig b/sound/soc/spacemit/Kconfig
index 2179f94f3f17..e11f600a327f 100644
--- a/sound/soc/spacemit/Kconfig
+++ b/sound/soc/spacemit/Kconfig
@@ -6,8 +6,7 @@ menu "SpacemiT"
 config SND_SOC_K1_I2S
 	tristate "K1 I2S Device Driver"
 	select SND_SOC_GENERIC_DMAENGINE_PCM
-	select CMA
-	select DMA_CMA
+	depends on DMA_CMA
 	help
 	  Say Y or M if you want to add support for I2S driver for
 	  K1 I2S controller. The device supports up to maximum of
-- 
2.52.0


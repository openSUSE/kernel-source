From: Takashi Iwai <tiwai@suse.de>
Subject: [PATCH v2] wifi: ath11k: Add quirk entries for Thinkpad T14s Gen3 AMD
Patch-mainline: Submitted, linux-wireless ML
References: bsc#1254181

The recent kernels showed a regression wrt suspend/resume on Lenovo
Thinkpad T14s Gen 3 AMD model; it fails to reconnect on resume after a
long time sleep.  The only workaround was to unload/reload the driver
(or reboot).

It seems that this model also requires the similar quirk with
ATH11K_PM_WOW which has been done for other Thinkpad models.

This patch adds two DMI entries ("21CQ" and "21CR") for T14s Gen 3
models to apply PM WoW workaround.

Link: https://bugzilla.suse.com/show_bug.cgi?id=1254181
Signed-off-by: Takashi Iwai <tiwai@suse.de>

---
 drivers/net/wireless/ath/ath11k/core.c | 14 ++++++++++++++
 1 file changed, 14 insertions(+)

diff --git a/drivers/net/wireless/ath/ath11k/core.c b/drivers/net/wireless/ath/ath11k/core.c
index 812686173ac8..4daaeb5e0ab8 100644
--- a/drivers/net/wireless/ath/ath11k/core.c
+++ b/drivers/net/wireless/ath/ath11k/core.c
@@ -924,6 +924,20 @@ static const struct dmi_system_id ath11k_pm_quirk_table[] = {
 			DMI_MATCH(DMI_PRODUCT_NAME, "21J4"),
 		},
 	},
+	{
+		.driver_data = (void *)ATH11K_PM_WOW,
+		.matches = { /* T14s G3 AMD #1 */
+			DMI_MATCH(DMI_BOARD_VENDOR, "LENOVO"),
+			DMI_MATCH(DMI_PRODUCT_NAME, "21CQ"),
+		},
+	},
+	{
+		.driver_data = (void *)ATH11K_PM_WOW,
+		.matches = { /* T14s G3 AMD #2 */
+			DMI_MATCH(DMI_BOARD_VENDOR, "LENOVO"),
+			DMI_MATCH(DMI_PRODUCT_NAME, "21CR"),
+		},
+	},
 	{
 		.driver_data = (void *)ATH11K_PM_WOW,
 		.matches = { /* T14 G4 AMD #1 */
-- 
2.52.0


From 644115e86023fccdaecb1318133ed14418b76f49 Mon Sep 17 00:00:00 2001
From: Richard Fitzgerald <rf@opensource.cirrus.com>
Date: Tue, 17 Dec 2024 10:56:24 +0000
Subject: [PATCH] firmware: cs_dsp: Fix endianness conversion in cs_dsp_mock_wmfw.c
Git-commit: 644115e86023fccdaecb1318133ed14418b76f49
Patch-mainline: v6.14-rc1
References: jsc#PED-14430 jsc#PED-14297 jsc#PED-14024

In cs_dsp_mock_wmfw_add_coeff_desc() the value stored in longstring->len
needs a cpu_to_le16() conversion.

Fixes: 5cf1b7b47180 ("firmware: cs_dsp: Add mock wmfw file generator for KUnit testing")
Reported-by: kernel test robot <lkp@intel.com>
Closes: https://lore.kernel.org/oe-kbuild-all/202412170233.8DnsdtY6-lkp@intel.com/
Signed-off-by: Richard Fitzgerald <rf@opensource.cirrus.com>
Link: https://patch.msgid.link/20241217105624.139479-1-rf@opensource.cirrus.com
Signed-off-by: Mark Brown <broonie@kernel.org>
Acked-by: Takashi Iwai <tiwai@suse.de>

---
 drivers/firmware/cirrus/test/cs_dsp_mock_wmfw.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/firmware/cirrus/test/cs_dsp_mock_wmfw.c b/drivers/firmware/cirrus/test/cs_dsp_mock_wmfw.c
index d3d84da239a3..5a3ac03ac37f 100644
--- a/drivers/firmware/cirrus/test/cs_dsp_mock_wmfw.c
+++ b/drivers/firmware/cirrus/test/cs_dsp_mock_wmfw.c
@@ -334,7 +334,7 @@ void cs_dsp_mock_wmfw_add_coeff_desc(struct cs_dsp_mock_wmfw_builder *builder,
 				  sizeof(*ple32)) / sizeof(*ple32);
 
 		longstring = (__force struct wmfw_long_string *)ple32;
-		longstring->len = description_len;
+		longstring->len = cpu_to_le16(description_len);
 		memcpy(longstring->data, def->description, description_len);
 
 		/* Round up to next __le32 multiple */
-- 
2.52.0


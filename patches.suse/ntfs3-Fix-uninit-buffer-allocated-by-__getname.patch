From: Sidharth Seela <sidharthseela@gmail.com>
Date: Tue, 23 Sep 2025 12:10:16 +0530
Subject: [PATCH] ntfs3: Fix uninit buffer allocated by __getname()
Git-commit: 9948dcb2f7b5a1bf8e8710eafaf6016e00be3ad6
Patch-mainline: v6.19-rc1
References: CVE-2025-68727 bsc#1255568

Fix uninit errors caused after buffer allocation given to 'de'; by
initializing the buffer with zeroes. The fix was found by using KMSAN.

Reported-by: syzbot+332bd4e9d148f11a87dc@syzkaller.appspotmail.com
Fixes: 78ab59fee07f2 ("fs/ntfs3: Rework file operations")
Signed-off-by: Sidharth Seela <sidharthseela@gmail.com>
Signed-off-by: Konstantin Komarov <almaz.alexandrovich@paragon-software.com>
Signed-off-by: David Sterba <dsterba@suse.com>
---
 fs/ntfs3/inode.c |    1 +
 1 file changed, 1 insertion(+)

--- a/fs/ntfs3/inode.c
+++ b/fs/ntfs3/inode.c
@@ -1711,6 +1711,7 @@ int ntfs_link_inode(struct inode *inode,
 	de = __getname();
 	if (!de)
 		return -ENOMEM;
+	memset(de, 0, PATH_MAX);
 
 	/* Mark rw ntfs as dirty. It will be cleared at umount. */
 	ntfs_set_state(sbi, NTFS_DIRTY_DIRTY);

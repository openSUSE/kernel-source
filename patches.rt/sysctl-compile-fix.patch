Subject: Linux-RT 2.6.27-RT
From: http://www.kernel.org/pub/linux/kernel/projects/rt/
Acked-by: Sven-Thorsten Dietrich <sdietrich@suse.de>
From ff046943540ea60399e552a86a825396d3bcaa9b Mon Sep 17 00:00:00 2001
From: Paul Gortmaker <paul.gortmaker@windriver.com>
Date: Thu, 25 Sep 2008 17:57:01 -0400
Subject: [PATCH] rt: sysctl compile fix for when profiling is off

prof_pid will be an unresolved symbol if you don't enable
profiling, and the final link of the kernel will fail. Make
the sysctl entry conditional on the appropriate Kconfig option.

This patch should be considered for merge into the existing
preempt-realtime-debug-sysctl.patch.

Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
---
 kernel/sysctl.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/kernel/sysctl.c b/kernel/sysctl.c
index 584969c..ba2239e 100644
--- a/kernel/sysctl.c
+++ b/kernel/sysctl.c
@@ -366,6 +366,7 @@ static struct ctl_table kern_table[] = {
 		.proc_handler	= &proc_dointvec,
 	},
 #endif
+#ifdef CONFIG_PROFILING
 	{
 		.ctl_name	= CTL_UNNUMBERED,
 		.procname	= "prof_pid",
@@ -374,6 +375,7 @@ static struct ctl_table kern_table[] = {
 		.mode		= 0644,
 		.proc_handler	= &proc_dointvec,
 	},
+#endif
 #ifdef CONFIG_PREEMPT
 	{
 		.ctl_name	= CTL_UNNUMBERED,
-- 
1.6.0.2


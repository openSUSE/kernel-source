Subject: Linux-RT 2.6.27-RT
From: http://www.kernel.org/pub/linux/kernel/projects/rt/
Acked-by: Tony Jones <tonyj@suse.de>
---
 include/asm-arm/arch-pxa/timex.h |    6 ++++++
 1 file changed, 6 insertions(+)

Index: linux-2.6.26.3-rt6/arch/arm/mach-pxa/include/mach/timex.h
===================================================================
--- linux-2.6.26.3-rt6.orig/arch/arm/mach-pxa/include/mach/timex.h	2008-09-05 00:21:59.000000000 -0400
+++ linux-2.6.26.3-rt6/arch/arm/mach-pxa/include/mach/timex.h	2008-09-05 00:22:59.000000000 -0400
@@ -16,6 +16,8 @@
 #define CLOCK_TICK_RATE 3686400
 #elif defined(CONFIG_PXA27x)
 /* PXA27x timer base */
+#include <asm-arm/arch-pxa/hardware.h>
+#include <asm-arm/arch-pxa/pxa-regs.h>
 #ifdef CONFIG_MACH_MAINSTONE
 #define CLOCK_TICK_RATE 3249600
 #else
@@ -24,3 +26,7 @@
 #else
 #define CLOCK_TICK_RATE 3250000
 #endif
+
+#define mach_read_cycles() OSCR
+#define mach_cycles_to_usecs(d) (((d) * ((1000000LL << 32) / CLOCK_TICK_RATE)) >> 32)
+#define mach_usecs_to_cycles(d) (((d) * (((long long)CLOCK_TICK_RATE << 32) / 1000000)) >> 32)
